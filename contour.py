import numpy as np
from uncertainties import unumpy as unp
from uncertainties import ufloat
import matplotlib.pyplot as plt
from scipy.stats import kde

########################### DATEN NOA #########################################

diameters_noa = [ufloat(73495.49921393981,22954.49618525488),ufloat(52763.370082744834,16528.33784256909),ufloat(34913.55261247508,11006.636652260078),ufloat(88028.6561162412,27536.64392235227),ufloat(78879.73643556522,24663.954576938213),ufloat(56091.6909240511,17602.241891842194),ufloat(94129.86181802509,29356.890588187496),ufloat(50435.381412696166,15784.50096895867),ufloat(39427.00114325513,12378.939940363594),ufloat(56049.81688199076,17526.23765716343),ufloat(36143.730151667594,11365.65191747316),ufloat(42540.631423790386,13339.474936889814),ufloat(32221.106634255106,10154.83095423218),ufloat(86329.32839147754,27055.933294966882),ufloat(153580.24799392468,48144.45948753004),ufloat(92760.8672306676,29056.249254496463),ufloat(147606.36045937054,46927.253958312474),ufloat(157382.23522214172,50471.705171381676),ufloat(44603.36096225548,14049.432535612561),ufloat(43494.57239999647,13723.55153921755),ufloat(59688.61195502076,18977.833028217272),ufloat(83649.14607931607,26221.298735741726),ufloat(34344.052699182306,10965.666361781263),ufloat(36796.03773478934,11770.273434099623),ufloat(65068.65729896898,20418.034824936378),ufloat(53931.17522898937,16916.126034033583),ufloat(49233.770240286496,15458.086440582678),ufloat(25373.294112337535,8110.7422375994265),ufloat(23225.52910549637,7455.406787638438),ufloat(21319.01141469412,6874.583486876912),ufloat(64294.31249822726,20105.60728759401),ufloat(42108.035398601554,13207.609006807566),ufloat(46699.668302067796,14627.210867766555),ufloat(91295.41198335733,28475.395417056257),ufloat(69849.22515443027,21810.280974407757),ufloat(43286.14829502947,13581.822816482321),ufloat(31602.222848287885,9977.297881761),ufloat(104887.4608190039,32775.663400248086),ufloat(51180.52438693844,16037.750794571375),ufloat(80844.62430717162,25304.151441074515),ufloat(65411.48358641764,20482.9120096861),ufloat(36756.14253309686,11735.167481614204),ufloat(39873.44265338571,12748.751425169716),ufloat(38907.054721457076,12477.259933337147),ufloat(67045.64850431286,20959.915167482097),ufloat(18831.964540020017,6134.703896822203),ufloat(23300.722726784363,7483.194086199853),ufloat(53035.315340867564,16633.83243932242),ufloat(59644.6332894466,18686.066878301823),ufloat(61379.62042764471,19245.247422589855),ufloat(87228.85222034645,27270.88883793532),ufloat(94891.47100521972,29675.453567335033),ufloat(50203.02126655512,15778.589290361775),ufloat(47391.14257731846,14925.571241873631),ufloat(94623.70034750548,29510.47736357684),ufloat(45920.722343354355,14386.009094077299),ufloat(37155.82749862743,11677.480828036298),ufloat(64373.17989686745,20109.566804874095),ufloat(87140.838734479,27308.54928957278),ufloat(32915.23810212836,10527.939014482841),ufloat(73328.81757502309,22983.37102810583),ufloat(43751.43234394825,13802.710278341723),ufloat(54217.48564759988,17021.421134583718),ufloat(81246.03985008325,25475.044097268874),ufloat(142235.33208810387,44617.99746673597),ufloat(55017.26861240609,17527.474376324994),ufloat(156718.99710017702,50832.467299130534),ufloat(125035.03287564224,40207.73310509283),ufloat(62995.04316778131,20380.987001336503),ufloat(40479.020794847354,12771.43366817059),ufloat(47218.055427121086,14968.28207428521),ufloat(47051.717109999125,14919.041989012921),ufloat(81358.7637560065,25463.931762111217),ufloat(59995.705667363356,18802.032830610595),ufloat(62304.859986458934,19488.529205072045),ufloat(55565.51312520657,17419.00177341651),ufloat(54496.71833595408,17091.516290402236),ufloat(51676.17847170514,16234.539869517099),ufloat(93711.42598762839,29351.733596317747),ufloat(139922.09904625197,43907.322034177494),ufloat(36139.65038715064,11571.710046028122),ufloat(33528.31438891701,10673.310619200194),ufloat(97810.64713877045,30574.24718049617),ufloat(60066.5167942589,18792.036848225343),ufloat(79456.40239004127,24842.959815902756),ufloat(89359.61076321993,27950.20180539661),ufloat(46652.14469842371,14688.387311013566),ufloat(45447.74374742454,14339.31575433735),ufloat(133696.72655114744,42192.313091481825),ufloat(108101.67467393412,33777.15593907855),ufloat(84296.98615397568,26855.261018745583),ufloat(148982.34889817054,46991.48625348731),ufloat(59565.80685778814,18813.437088817984),ufloat(85598.82042353778,26828.741631230856),ufloat(155328.22369205393,49944.72228945826),ufloat(148572.57938909222,48220.49091939625),ufloat(62571.00537795373,20222.870795317267),ufloat(102856.50931215913,33881.25200890472),ufloat(123207.35432081806,41583.646527670084),ufloat(64516.12585204529,20174.247029512346),ufloat(25338.78498675581,8099.6712715281465),ufloat(49900.21015639786,15664.842102055247),ufloat(52367.47813760412,16432.428916513043),ufloat(49321.38998710965,15506.172890810658),ufloat(72595.10718406006,22725.3165106954),ufloat(29060.79755983259,9198.845401450606),ufloat(32300.348212797475,10192.107632585563),ufloat(113851.71845470686,35568.46798592655),ufloat(127701.95326137354,40322.392039202445),ufloat(89596.78492673146,28522.452596751158),ufloat(51172.412090654034,16109.78637673807),ufloat(48044.86247640917,15116.84962659383),ufloat(118728.02034903255,38323.219884588696)]


depths_noa = [ufloat(3509.910512744653,1279.256106167084),ufloat(3272.04594261261,1289.4717071716411),ufloat(4756.52956166504,1685.0894272760975),ufloat(15181.31985157294,4872.164340539892),ufloat(10142.405917476983,3356.2645799560123),ufloat(16613.68537633915,5355.187895772717),ufloat(3660.2268288252426,1212.3538813510288),ufloat(1240.8132479133337,452.8920309504545),ufloat(237.5261549770623,158.3646795328327),ufloat(3776.737620941982,1281.3585045814295),ufloat(6915.805911700624,2385.291282800826),ufloat(3769.139530672368,1592.368712682903),ufloat(6557.330749757724,2304.1671828743247),ufloat(3291.376259149651,1215.0356271235516),ufloat(2785.7822911397325,993.6513965454835),ufloat(1702.4073793168066,653.4452983983865),ufloat(7407.198478301907,2726.452006143569),ufloat(7683.546484330334,2612.792763508506),ufloat(1859.3755864282277,673.7376353837981),ufloat(2330.973051589952,848.5685524875502),ufloat(2251.2563590219524,843.1046436732273),ufloat(4975.086283661394,1695.278102866116),ufloat(2791.3944103927993,991.7092978943942),ufloat(3249.7399372244968,1139.0988957525065),ufloat(3673.9372070219392,1251.6904738585442),ufloat(699.5175562890907,305.81778630466397),ufloat(315.9067507988481,240.26525941175487),ufloat(649.1323515863239,276.72847867635187),ufloat(877.9592047099989,363.717140140027),ufloat(977.4169833195476,399.398403366819),ufloat(2185.336268925771,762.0059362509602),ufloat(342.9756638091352,209.5272815494994),ufloat(1165.9324621711662,428.8992439861987),ufloat(2561.798694341755,865.6476184570565),ufloat(4587.458682613538,1520.1828016980783),ufloat(3032.2931694102986,1047.2338426419037),ufloat(999.9950683141436,389.06060355579876),ufloat(2185.0135877455723,855.100658825641),ufloat(3726.5110874391094,1405.7253519393287),ufloat(12502.592011500828,4059.729485382406),ufloat(7258.802669947916,2523.6024956478013),ufloat(3151.8190296561743,1277.6260667256151),ufloat(3924.6393686954,1412.2441348898378),ufloat(5807.314398183166,2100.075378899231),ufloat(2022.101105582374,710.3013339889874),ufloat(873.8296787114454,357.3353770378216),ufloat(476.6850221590081,225.72195174840405),ufloat(208.8349759183868,187.04062043526207),ufloat(687.4384940819334,305.6529984177462),ufloat(388.4513100386609,203.02002658493606),ufloat(513.256262166208,640.5686304774581),ufloat(324.14161746151956,825.9469478034395),ufloat(2719.8552162690917,939.6722145005232),ufloat(3040.6475177117886,1055.0887505179212),ufloat(2963.9650490685117,991.7576049627893),ufloat(1125.8523195604037,416.2352273760714),ufloat(355.5320754161429,225.33834813252943),ufloat(3792.6001087694294,1285.0843896563804),ufloat(4985.516455915932,1696.9620375106365),ufloat(2106.9618557887475,795.7056516354631),ufloat(2123.9565377728495,800.1242459295601),ufloat(2806.8632461336333,985.9739866738612),ufloat(2072.2516126453356,739.4090042073752),ufloat(1863.3716299820599,699.6504675256306),ufloat(2611.5218147160017,940.845474125613),ufloat(2231.1241715430506,838.3301938031674),ufloat(7656.589130403396,2892.1662755762845),ufloat(7897.614013120188,2678.750433725596),ufloat(5243.50075512952,1851.9850973231798),ufloat(2414.2237796943514,1023.7749784383874),ufloat(1604.382181647117,620.137746059186),ufloat(3317.192971247926,1161.4303633342988),ufloat(7907.333482433733,2704.9067257715237),ufloat(5827.410358918063,2131.357087204131),ufloat(2141.7542713572793,748.998777920636),ufloat(241.54837845154054,201.00528150157666),ufloat(759.6976350077877,333.24588352885837),ufloat(1553.5672289137397,583.1555293461577),ufloat(2382.012749903074,852.6809434091812),ufloat(3921.4262528526137,1354.4372797240778),ufloat(1471.813003809277,577.84843191511),ufloat(390.85479749033675,209.3699038280541),ufloat(2247.153981803006,867.4586988009698),ufloat(6690.748748841919,2234.122512040454),ufloat(9596.502708257904,3194.1343898727814),ufloat(11545.017521807546,3772.378436381219),ufloat(233.4357276577872,174.63759964621943),ufloat(175.21822847308857,174.57871550894737),ufloat(1916.2420681248598,1193.812806148567),ufloat(2990.2217000926657,1072.300175142354),ufloat(2425.0048696430003,928.5457649590488),ufloat(1853.2791909898406,1078.4311819485265),ufloat(918.3326120770612,420.73008590066826),ufloat(4415.844632992563,1530.8359799981147),ufloat(7522.219824609659,2558.5911222895793),ufloat(7369.875795921213,2786.0369300847324),ufloat(4700.7590340005645,1688.7568054471103),ufloat(8827.536892760147,2997.0874531976365),ufloat(17077.314905073094,5654.933794224806),ufloat(1533.2004888312242,554.4619671783227),ufloat(870.4495327724543,350.5450469968008),ufloat(141.7960028480308,140.6654147985401),ufloat(604.061476953882,272.89346730760644),ufloat(1882.2981157578809,680.5144607469294),ufloat(374.99455548578845,197.45038069513274),ufloat(1651.6412754898918,671.6154463939923),ufloat(919.1444299468109,365.5666003096583),ufloat(1633.8786594303426,721.5767204156248),ufloat(1752.1212799678788,1237.454845664634),ufloat(2385.479846922182,913.9862937071143),ufloat(170.2740188742606,154.09250883516222),ufloat(228.48796248444077,173.03109989152244),ufloat(5660.928977577389,1999.1802694508478)]

##############################################################################

######################### DATEN JENNY ########################################

diameters_jenny = [ufloat(73464.21868013045,31935.485785861936), ufloat(80647.09861973715,34156.50100781641), ufloat(39885.97608868405,15967.119727136058), ufloat(172572.40166910912,69674.12406413665), ufloat(40339.12229679334,16501.45044416108), ufloat(20494.906476174314,8443.223971741403), ufloat(38221.20848920158,15358.74784069586), ufloat(91841.75719673837,37829.013355483774), ufloat(59661.52239943573,25136.670522979224), ufloat(84124.59910199883,36891.509181736634), ufloat(72505.95832228895,28707.086669121134), ufloat(114804.25201773607,45615.915729379725), ufloat(79454.9150347115,31455.474029713107), ufloat(55227.58304961364,21846.758363375466), ufloat(30873.19982884826,12250.69158971026), ufloat(72890.62099311655,28779.80371748585), ufloat(71619.49665530445,28281.26149000471), ufloat(25589.105456581285,10158.563695709845), ufloat(33259.88358839843,13162.819769820602), ufloat(56784.62567473886,22434.66485893302), ufloat(59734.55670354035,23626.094564113995), ufloat(194859.0889310188,78719.90072853606), ufloat(52839.32441437539,21615.560209673997), ufloat(86905.5356644882,36006.139944816394), ufloat(116124.75602483767,46164.23309554902), ufloat(87667.50723042298,34701.00851090629), ufloat(30186.701285831663,11993.561702059555), ufloat(47172.83609339214,18670.297466284104), ufloat(183461.13015246295,73973.76637442883), ufloat(47391.66798139434,19383.045609877663), ufloat(25789.498090530513,10547.907228778802), ufloat(44198.16660914702,17649.20576868809), ufloat(94557.25871887474,38944.55801782195), ufloat(64916.44848798346,27611.743039691482), ufloat(74913.87865052227,33139.23382962112), ufloat(58304.49767501257,23007.611076284255), ufloat(68422.86172150566,27000.808194451194), ufloat(113942.10966244964,44962.685463163434), ufloat(27981.15511177714,11096.640141495238), ufloat(54557.836338336136,21577.22141627914), ufloat(41144.823910472995,16300.035347942565), ufloat(69945.6435524606,27689.4210557261), ufloat(33867.65498157714,13402.27855323886), ufloat(51041.683229710696,20190.141910575654), ufloat(77628.59256886526,30603.39214951141), ufloat(34556.45893514109,13643.354803781402), ufloat(105165.68909499643,41445.635501974335), ufloat(27815.864987848574,10991.273354680248), ufloat(45645.47196556891,18043.144169353036), ufloat(37782.634052057416,14963.702622422768), ufloat(42332.430948350004,16740.21159698341), ufloat(100628.15073849818,39743.06317744655), ufloat(63270.81158093378,26338.789349757586), ufloat(118103.82468176815,47825.1741241147), ufloat(48675.06383057588,19754.64005266275), ufloat(53725.92322102244,21490.95853394279), ufloat(28266.0606010086,11299.484860954915), ufloat(51290.504512590094,20824.315205003957), ufloat(96183.62098165635,38474.57143180843), ufloat(36828.35217319309,14677.500354957932)]

depths_jenny = [ufloat(17918.320728556835,7529.04661651516), ufloat(9186.082332941165,3856.0535788436828), ufloat(7852.7862801714455,3190.781753271008), ufloat(12097.458047983802,5023.464180445637), ufloat(7440.356594602052,3095.3671836459766), ufloat(4109.112501947977,1730.9403016533824), ufloat(7963.695077083662,3269.7825119543472), ufloat(16663.16734728913,7339.970000827568), ufloat(13522.381313849997,5640.968929191404), ufloat(20228.832182654198,8507.225336236783), ufloat(8018.3441851425505,3257.2146338158877), ufloat(5139.241797153297,2260.629607184079), ufloat(3742.294356676908,1647.4819759119791), ufloat(3022.660889438355,1274.08120881075), ufloat(3480.339021369081,1443.1963619706646), ufloat(3582.5066990043965,1473.1430392547675), ufloat(2839.533563249037,1184.879388128823), ufloat(3982.8272975128625,1668.239794859612), ufloat(4005.1719526418447,1746.7506146692263), ufloat(1608.4053543911093,1043.7310217664149), ufloat(2849.7476550480233,1205.5513504715805), ufloat(9654.542844254956,4023.0513620289676), ufloat(7210.715731362647,3004.127639658404), ufloat(13864.384235935962,6167.739001034327), ufloat(5192.167952890687,2299.9558836879146), ufloat(4236.9094617559995,1831.0164147374294), ufloat(4477.660801023265,1880.0167615383862), ufloat(3401.1117376499083,1432.5929576181925), ufloat(10994.057023693487,4549.385002514667), ufloat(6654.061057447346,2771.846243445938), ufloat(4529.769038523417,1898.2467369242374), ufloat(5348.4915589777775,2197.3090260516738), ufloat(15743.08624554872,6935.195832068968), ufloat(13934.839115187522,5839.261763166638), ufloat(18963.650251267947,7998.299544753082), ufloat(4098.824802384646,1697.3955801039824), ufloat(9727.369182596785,3888.038222376133), ufloat(5964.4621667109295,2413.8594686199467), ufloat(5291.051419224394,2152.289482049555), ufloat(8239.5910091244,3311.089120019134), ufloat(7470.893711824624,3011.2456353801), ufloat(3854.2199711653866,1589.9473739417563), ufloat(2285.3224203967734,1008.8890664069553), ufloat(1625.984240316662,1779.4736849256733), ufloat(5445.5179993606,2197.781572822948), ufloat(6192.963975385997,2487.8134531840615), ufloat(8108.830299138441,3240.918998525817), ufloat(3247.6065338175913,1331.705041822164), ufloat(359.88364127013665,387.07470934528067), ufloat(183.80880870444366,395.15656012509606), ufloat(-407.53173522242935,441.21863042545095), ufloat(3407.849518555512,1411.3555168209668), ufloat(11435.74640776536,4766.196554157191), ufloat(7200.384914027618,3027.5631162803147), ufloat(4717.920158225956,2079.8577252318223), ufloat(4406.468319996395,1847.5517623079547), ufloat(5798.262802455725,2374.978039513861), ufloat(4854.102660592055,2130.502105537506), ufloat(3360.8915814640723,2340.2513015766817), ufloat(1536.8066660554448,732.1337897538268)]
##############################################################################

########################## DATEN TIM #########################################
diameters_tim=[96.55602614296915, 76.79014420078865, 63.716618603355776, 50.37227863977109, 86.61052643241867, 56.125843123388954, 114.29780286755567, 31.824630021178255, 52.59769642959123, 64.43419780456802, 62.1062486257311, 67.87667750019538, 52.08791399646298, 38.80368911941519, 32.116844634055745, 26.222805719562505, 41.93665724587169, 50.645346962402265, 42.31150967917929, 46.73167991969433, 52.259402721853604, 50.27469745642094, 54.709564517370026, 48.3399391348761, 57.86631998809206, 50.683325367754456, 60.20743133456533, 122.2816549477394, 77.91982528329564, 101.52653758801871, 69.62196263188865, 35.3133494546471, 30.4933752361911, 22.378159176899135, 56.05054547749617, 27.80051198604932, 50.719655194517706, 41.81041510587009, 38.90411626393028, 28.041651934043596, 27.105121094572034, 71.9193588501077, 69.17762508644354, 60.40540479849026, 69.55971214918725, 82.10922387106407, 90.13233516281048, 50.87687709969659, 83.72004551852802, 30.67033071717297, 79.36577204594103, 68.81952783569605, 40.0225316050507, 96.15890877245145, 142.14033797406873, 114.88103705846488, 30.92118655933279, 60.682757415569185, 100.67745368119564, 83.11098613872998, 65.09730301019557, 25.247704988829902, 47.58579128182706, 33.60066035447534, 76.19197941316234, 27.40375076890841, 38.62718867589704, 25.60195758464967, 47.201327830457664, 81.93964625253145, 46.799943335648734, 27.933800712207617, 33.50805653900822, 28.56636988772807, 41.89158296252605, 55.824635010661325, 115.42474378749588]

depths_tim=[18.11957439946039, 14.801049565823387, 6.394478898837045, 8.188580570157713, 11.932548186376064, 8.171241787343938, 16.86740615594715, 5.692600412335863, 5.317377677076771, 4.360952015101568, 5.573785628639757, 5.169544603335047, 5.932672603992888, 4.7331984768302435, 3.816757200547304, 1.4260455750926972, 4.582312195976344, 4.401226971638373, 4.8883087009886035, 3.689317294082723, 3.7900066463707236, 4.05321008400995, 5.844690322035747, 5.904565101639111, 5.671476564171934, 3.037495992675581, 3.905767153861893, 7.009825959168699, 7.593986423733439, 4.834391195248487, 2.291751236097408, 2.500314050413041, 3.128036767248551, 1.574130068829935, 3.3934925050660687, 3.4188428704967175, 3.8691634404485535, 3.107949648890301, 3.98756562285024, 2.7996012483116797, 2.5314177733317527, 1.8120641674532099, 3.0369399504637045, 5.317200542875082, 2.859521425435096, 9.425048789824869, 8.676205820276566, 3.2955847233303937, 5.465937653976308, 1.5865554208763926, 3.274994558669847, 2.043997036595142, 3.9845553524597497, 6.341316865588796, 7.635442883876756, 6.971760750546008, 4.012050466139838, 4.840353995275345, 2.2328957072261955, 7.22929251950505, 3.239131493985928, 4.15543235625333, 4.57705704192613, 4.6084684051218, 1.5526903215979893, 3.7621623671937963, 4.967237377805865, 4.955879402150792, 3.1467198317477414, 9.286073111244404, 4.187288899632668, 1.6913966115669565, 4.007091786205231, 3.7644702752368207, 8.034235036638487, 8.078641721987115, 4.113279496151853]
##############################################################################

diameters_all = (unp.nominal_values(diameters_noa)/1000).tolist() + (unp.nominal_values(diameters_jenny)/1000).tolist() + diameters_tim
depths_all = (unp.nominal_values(depths_noa)/1000).tolist() + (unp.nominal_values(depths_jenny)/1000).tolist() + depths_tim

diameters12mm = unp.nominal_values(diameters_jenny)/1000
depths12mm = unp.nominal_values(depths_jenny)/1000

diameters20mm = np.asarray((unp.nominal_values(diameters_noa)/1000).tolist() + diameters_tim)
depths20mm = np.asarray((unp.nominal_values(depths_noa)/1000).tolist() + depths_tim)


############### contour plot #######################
x = np.asarray(diameters_all)
y = np.asarray(depths_all)


# Evaluate a gaussian kde on a regular grid of nbins x nbins over data extents
nbins = 20
k = kde.gaussian_kde((x,y))
xi, yi = np.mgrid[x.min():x.max():nbins*1j, y.min():y.max():nbins*1j]
zi = k(np.vstack([xi.flatten(), yi.flatten()]))


fig, axes = plt.subplots(ncols=1,nrows=1,figsize=(21,10))
plt.title('Contour plot of crater properties; All data ', fontsize=18)
axes.plot(diameters12mm, depths12mm, 'o', color='blue', marker='.', label='Magnification: 12 mm')
axes.plot(diameters20mm, depths20mm, 'o', color='black', marker='.', label='Magnification: 20 mm')
axes.contour(xi,yi,zi.reshape(xi.shape) )
axes.set_xlabel('Diameter [km]',fontsize=14)
axes.set_ylabel('Depth [km]',fontsize=14)
chartBox = axes.get_position()
axes.set_position([chartBox.x0, chartBox.y0, chartBox.width*0.6, chartBox.height])
axes.legend(loc='upper right', bbox_to_anchor=(1.0,1.0), fontsize=14)
plt.savefig('contour_plot_all.pdf', bbox_inches='tight')


plt.show()
